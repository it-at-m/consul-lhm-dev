<%= render "shared/loader_spinner" %>

<div class="flex-layout flex-layout-reverse-on-mobile">
  <div class="main-column">

    <div class="new-resource-cta">
      <%= render Shared::NewButtonComponent.new(projekt_phase: @projekt_phase) %>
    </div>

    <%= render(
      Shared::ResourcesListComponent.new(
        resources: @debates,
        resource_type: Debate,
        remote_url: projekt_footer_phase_filter_url(@projekt_phase),
        text_search_enabled: true,
        current_filter: @current_order,
        filter_param: "order",
        filters: @valid_orders,
        empty_list_text: t("custom.debates.index.empty_list_text")
      ))
    %>
  <%= paginate @debates, remote: true, params: { controller: "pages", action: "projekt_phase_footer_tab" } %>
  </div>

  <div id="debates-sidebar" class="sidebar">
    <% content_block_sidebar_name = "projekt_phase_footer_sidebar_#{@projekt_phase.id}" %>
    <% if render_custom_projekt_content_block?(content_block_sidebar_name, @projekt_phase.projekt) %>
      <%= render Shared::SidebarCardComponent.new(title: "Beteiligunsinformation", icon_name: "info-circle") do |c| %>
        <%= render_custom_block content_block_sidebar_name %>
      <% end %>
    <% end %>

    <% if current_user.present? && extended_feature?('debates.enable_my_posts_filter') %>
      <%= render Sidebar::Filters::MyPostsCardComponent.new %>
    <% end %>

    <%= render Sidebar::ExportListComponent.new(
      path: admin_proposals_path(**request.query_parameters, format: :csv),
    ) %>
  </div>
</div>
