<%= content_for :body_class, "custom-page" %>
  <% provide :title do %><%= @custom_page.title %><% end %>

<style>
  <% if @custom_page.image.present? %>
    .custom-page-banner {
      background-image: url("<%= url_for(@custom_page.image.attachment) %>");
      background-size: cover;
      background-position: center center;
    }
  <% end %>
</style>

<main class="projekt-page">
  <% if @custom_page.subtitle.blank? && @custom_page.image.blank? %>
    <h1 class="custom-page--title margin-bottom">
      <%= @custom_page.title %>
    </h1>
  <% else %>
    <div class="custom-page--banner-wrapper">
      <div class="custom-page--banner">
        <div class="custom-page--banner-text-section-wrapper">
          <div class="custom-page--banner-text-section">
            <h1 class="custom-page--banner-title">
              <%= @custom_page.title %>
            </h1>

            <% if @custom_page.subtitle.present? %>
              <div class="custom-page--banner-description">
                <%= @custom_page.subtitle %>
              </div>
            <% end %>
          </div>

          <% if @custom_page.projekt.present? %>
            <div class="custom-page--banner-breadcrumbs">
              <%= breadcrumbs_links(@custom_page.projekt) %>
            </div>
          <% end %>
        </div>

        <% if @custom_page.image.present? %>
          <%= image_tag(url_for(@custom_page.image.attachment), class: "custom-page--banner-image" )  %>
        <% end %>
      </div>
    </div>
  <% end %>

  <% if @custom_page.projekt.present? %>
    <% projekt_content = capture do  %>
        <div class="main-content-card">
          <%= render 'custom_page_content' %>
        </div>
    <% end %>
  <% end %>

  <%# <% if @custom_page.projekt.present? && projekt_feature?(@custom_page.projekt, 'general.show_projekt_footer') %>
  <% if @custom_page.projekt.present? && @custom_page.projekt.projekt_phases.active.any? %>
    <% projekt_footer = capture do %>
      <div class="projekt-footer flex-layout">
        <div class="full-width-column">
          <%= render Pages::Projekts::FooterPhasesComponent.new(@custom_page.projekt, @default_phase_name) %>
          <div id="footer-content" class="js-projekt-footer-content">
            <%= render 'shared/loader_spinner' %>
            <%= render "pages/projekt_footer_new/#{@default_projekt_phase.name}" %>
          </div>
        </div>
      </div>
    <% end %>
  <% end %>

  <% if @custom_page.projekt.present? %>
    <div class="show-on-desktop">
      <div class="flex-layout">
        <div class="main-column">
          <%= projekt_content %>
        </div>
        <% if @custom_page.projekt.present? %>
          <!-- <div class="projekt-sidebar margin-bottom"> -->
          <%= render partial: 'pages/sidebar_new', locals: { projekt: @custom_page.projekt, id_prefix: "desktop" } %>
          <!-- </div> -->
        <% end %>
      </div>
    </div>
  <% else %>
    <div class="show-on-desktop">
      <div class="main-column">
        <%= render 'custom_page_content' %>
      </div>
    </div>
  <% end %>

  <div class="show-on-desktop">
    <div class="projekt-footer-anchor" id="projekt-footer"> </div>
    <%= projekt_footer %>
  </div>

  <% if @custom_page.projekt.present? %>
    <!-- <div class="show-on-mobile"> -->
    <!--   <div class="mobile-projekt-tabs"> -->
    <!--     <ul class="tabs mobile-projekt-tabs-navigation" data-tabs id="example-tabs"> -->
    <!--       <li class="tabs-title mobile-projekt-tab is-active"><a href="#projekt-mobile-description-tab" aria-selected="true">Inalt</a></li> -->
    <!--       <li class="tabs-title mobile-projekt-tab"><a data-tabs-target="projekt-mobile-sidebar-content-tab" href="#projekt-mobile-sidebar-content-tab">Info</a></li> -->
    <!--       <li class="tabs-title mobile-projekt-tab"><a data-tabs-target="projekt-mobile-footer-tab" href="#projekt-mobile-footer-tab">Beteiligung</a></li> -->
    <!--     </ul> -->
    <!--  -->
    <!--     <div class="mobile-projekt-tabs-content tabs-content" data-tabs-content="example-tabs"> -->
    <!--       <div class="tabs-panel is-active" id="projekt-mobile-description-tab"> -->
    <!--         <div class="flex-layout"> -->
    <!--           <div class="main-column"> -->
    <!--             <%= projekt_content %> -->
    <!--           </div> -->
    <!--         </div> -->
    <!--       </div> -->
    <!--       <div class="tabs-panel" id="projekt-mobile-sidebar-content-tab"> -->
    <!--         <% if @custom_page.projekt.present? %> -->
    <!--           <div class="flex-layout"> -->
    <!--             <div class="projekt-sidebar margin-bottom"> -->
    <!--               <%= render partial: 'pages/sidebar_new', locals: { projekt: @custom_page.projekt, id_prefix: "mobile" } %> -->
    <!--             </div> -->
    <!--           </div> -->
    <!--         <% end %> -->
    <!--       </div> -->
    <!--       <div class="tabs-panel" id="projekt-mobile-footer-tab"> -->
    <!--         <%= projekt_footer %> -->
    <!--       </div> -->
    <!--     </div> -->
    <!--   </div> -->
    <!-- </div> -->
  <% end %>
</main>

<script>
  App.Projekts.toggleDefaultProjekts();
</script>
